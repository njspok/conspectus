# Логические компоненты

Архитектура 
- логическая - функциональные блоки
- физическая - реализация логической, базы данных, сервисы, API, etc

Логическая архитектура
```plantuml
class Orders
class Payment
class Catalog
class Cart

Cart --> Catalog
Cart <- Orders
Orders -> Payment
```

Физическая архитектура, монолит
```plantuml
component App {
    component Orders
    component Payment
    component Cart
    component Catalog
}
database Db {
}

App --> Db
```

Физическая архитектура, микросервисы
```plantuml
component Orders
component Payment
component Cart
component Catalog

database OrdersDB
database PaymentDB
database CartDB
database CatalogDB

Orders --> OrdersDB
Payment --> PaymentDB
Cart --> CartDB
Catalog --> CatalogDB

Cart -> Catalog
Orders -> Cart
Payment <- Orders
```

Не всегда компоненты будут преобразованы в сервисы.

## Цикл планирования архитектуры

Цикл планирования логических компонентов
- 01 выявление основных компонентов
- 02 назначение требований компонентам
- 03 анализ ролей и обязанностей
- 04 анализ архитектурных характеристик

Эти шаги позволяют избежать хаоса в структуре приложения.

### 01 Выявление основных компонентов

Для начала ыы просто стараемся угадать структуру ПО.
Исходя из анализа описания кейсов использования системы и ее функций.

Компоненты не должны быть "расплывачатымми", но и не слишком "подробными".

Избегайте использования слов менеджер, супервизор, координатор для имен компонентов.

Подходы, позволяющие выявить компоненты
- рабочие процессы
- субъекты и действия, кейсы использования системы

#### Рабочие процессы

Например, аукцион
- регистрация
- подключение к сеансу торгов
- просмотр трансляции
- подача ставки
- оплата в случае победы

Это не значит что каждый кейс - это свой компонент. Связь может быть как 1-1, так и 1-N.

#### Субъекты и действия

Субъект (интересант) и действия которые он может совершать.

Например, аукцион
- клиент
  - найти предложение
  - посмотреть трансляцию
  - сделать ставку
- менеджер
  - принять ставку
  - начать торги
  - завершить торги, определив победителя
- система
  - оплата лота
  - отслеживание действий торгов

#### Сравнение

| ситуация                                      | рабочий процесс | субъект-действие |
|-----------------------------------------------|-----------------|------------------|
| в системе 1 пользователь                      | +               |                  |
| в системе четко определенные сущности         | +               | +                |
| функциональные требования минимальны          | +               | +                |
| пользователь выполняет много сложных действий | +               |                  |
| в системе много типов пользователей           |                 | +                |

### 02 Назначение требований к компонентам

Сопоставляем пользовательскую историю с компонентом.

Например, аукцион и его компоненты
- сеанс торгов
  - отображение текущего торга
  - отметить текущий торг как завершенный
- прием ставок
  - сделать ставку
- онлайн трансляция
  - запись видео
- каталог торгов
  - просмотр торго участниками

Например, утилизация оргтехники. Основные функции - приемка, оценка, утилизация.
- прием
  - фиксация факта приема устройства у клиента
- оценка
  - определение стоимости устройства
- утилизация
  - поиск пункта утилизации
  - размещение объявление на стороннем сайте о перепродаже
- каталог клиентов
  - хранение информации о клиенте
- оплата
  - выплата вознаграждение клиенту
- финансовая отчетность
  - ежемесячное определение прибыли

### 03 анализ ролей и обязанностей

Посмотреть какие компоненты и какую работу в итоге выполняют.
Возможно, что на компонент возложено мало или много обязанностей, тогда
- Значит нужно вернутся и перераспределить их
- Возможно выделить новые компоненты

Функции компонентов должны быть связанными.

### 04 анализ архитектурных характеристик

